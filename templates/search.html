{% extends 'base.html' %}
{% block title %}–ü–æ—à—É–∫ ‚Äî MySocial{% endblock %}

{% block body %}
<div class="app-container">

  <aside class="sidebar-left">
    <div class="sidebar-logo">MySocial</div>
    <a href="/" class="nav-item"><span class="nav-icon">üè†</span> –°—Ç—Ä—ñ—á–∫–∞</a>
    <a href="/search" class="nav-item active"><span class="nav-icon">üîç</span> –ü–æ—à—É–∫</a>
    <a href="/notifications" class="nav-item"><span class="nav-icon">üîî</span> –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è<span class="nav-badge" data-notif>0</span></a>
    <a href="/profile/{{ session.username }}" class="nav-item"><span class="nav-icon">üë§</span> –ü—Ä–æ—Ñ—ñ–ª—å</a>
    <button class="sidebar-post-btn" onclick="openModal('modal-post')">+ –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ—Å—Ç</button>
    <a href="/profile/{{ session.username }}" class="sidebar-user">
      <div class="avatar avatar-sm" style="background:{{ session.get('accent','#6366f1') }}">{{ session.username[0].upper() }}</div>
      <div class="sidebar-user-info"><div class="sidebar-username">{{ session.username }}</div></div>
    </a>
  </aside>

  <main class="main-feed">

    <div class="top-bar">
      <div class="top-bar-logo">MySocial</div>
    </div>

    <div class="search-bar-wrap">
      <form action="/search" method="GET">
        <div class="search-bar">
          <span class="search-bar-icon">üîç</span>
          <input class="search-input" name="q" type="search"
                 placeholder="–ü–æ—à—É–∫ –ª—é–¥–µ–π..."
                 value="{{ q or '' }}" autofocus>
        </div>
      </form>
    </div>

    {% if q and users %}
      <div class="section-title">–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –¥–ª—è "{{ q }}"</div>
      {% for user in users %}
        <div class="search-user-card">
          <a href="/profile/{{ user.username }}">
            <div class="avatar avatar-md" style="background:{{ user.avatar_color }}">
              {{ user.username[0].upper() }}
            </div>
          </a>
          <div class="search-user-info">
            <a href="/profile/{{ user.username }}" class="search-username">{{ user.username }}</a>
            <div class="search-meta">{{ user.followers_count }} –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤</div>
          </div>
          <button class="suggest-follow-btn follow-btn-ajax {% if user.is_following %}following{% endif %}"
                  data-user-id="{{ user.id }}"
                  style="font-size:0.875rem;font-weight:700;color:var(--accent);">
            {% if user.is_following %}–ü—ñ–¥–ø–∏—Å–∞–Ω–∏–π{% else %}–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—å{% endif %}
          </button>
        </div>
      {% endfor %}

    {% elif q %}
      <div class="empty-state">
        <div class="empty-icon">üîç</div>
        <div class="empty-text">–ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</div>
        <div class="empty-sub">–°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à–∏–π –∑–∞–ø–∏—Ç</div>
      </div>

    {% else %}
      {% if trending %}
        <div class="section-title">–£ —Ç—Ä–µ–Ω–¥—ñ</div>
        <div class="trending-grid">
          {% for post in trending %}
            <div class="trending-item">
              <span>üìù</span>
              <div style="position:absolute;inset:0;background:rgba(0,0,0,0);transition:background 0.2s;display:flex;align-items:flex-end;padding:6px;">
              </div>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endif %}

  </main>

  <aside class="sidebar-right"></aside>
</div>

<nav class="bottom-nav">
  <a href="/" class="bottom-nav-item"><span class="bnav-icon">üè†</span><span>–°—Ç—Ä—ñ—á–∫–∞</span></a>
  <a href="/search" class="bottom-nav-item active"><span class="bnav-icon">üîç</span><span>–ü–æ—à—É–∫</span></a>
  <div class="bottom-nav-post"><button class="bottom-nav-post-btn" onclick="openModal('modal-post')">Ôºã</button></div>
  <a href="/notifications" class="bottom-nav-item"><span class="bnav-icon">üîî</span><span>–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è</span><span class="bnav-badge" data-notif></span></a>
  <a href="/profile/{{ session.username }}" class="bottom-nav-item"><span class="bnav-icon">üë§</span><span>–ü—Ä–æ—Ñ—ñ–ª—å</span></a>
</nav>
{% endblock %}