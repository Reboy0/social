{% extends 'base.html' %}
{% block title %}–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è ‚Äî MySocial{% endblock %}

{% block body %}
<div class="app-container">

  <aside class="sidebar-left">
    <div class="sidebar-logo">MySocial</div>
    <a href="/" class="nav-item"><span class="nav-icon">üè†</span> –°—Ç—Ä—ñ—á–∫–∞</a>
    <a href="/search" class="nav-item"><span class="nav-icon">üîç</span> –ü–æ—à—É–∫</a>
    <a href="/notifications" class="nav-item"><span class="nav-icon">üîî</span> –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è</a>
    <a href="/profile/{{ session.username }}" class="nav-item active"><span class="nav-icon">üë§</span> –ü—Ä–æ—Ñ—ñ–ª—å</a>
    <button class="sidebar-post-btn" onclick="openModal('modal-post')">+ –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ—Å—Ç</button>
    <a href="/profile/{{ session.username }}" class="sidebar-user">
      <div class="avatar avatar-sm" style="background:{{ session.get('accent','#6366f1') }}">{{ session.username[0].upper() }}</div>
      <div class="sidebar-user-info"><div class="sidebar-username">{{ session.username }}</div></div>
    </a>
  </aside>

  <main class="main-feed">

    <div class="top-bar">
      <a href="/profile/{{ user.username }}" class="icon-btn">‚Üê</a>
      <div style="font-weight:700;">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å</div>
      <div style="width:36px;"></div>
    </div>

    <form action="/profile/{{ user.username }}/edit" method="POST">

      {# Bio #}
      <div class="settings-section">
        <div class="settings-label">–ü—Ä–æ —Å–µ–±–µ</div>
        <textarea class="textarea-input" name="bio" placeholder="–†–æ–∑–∫–∞–∂—ñ—Ç—å –ø—Ä–æ —Å–µ–±–µ..." maxlength="200">{{ user.bio or '' }}</textarea>
      </div>

      {# Avatar color #}
      <div class="settings-section">
        <div class="settings-label">–ö–æ–ª—ñ—Ä –∞–≤–∞—Ç–∞—Ä–∞</div>
        <div class="color-grid">
          {% set avatar_colors = ['#6366f1','#a855f7','#ec4899','#f43f5e','#f97316','#eab308','#10b981','#06b6d4','#3b82f6','#0f172a','#78716c','#64748b'] %}
          {% for color in avatar_colors %}
            <div class="color-swatch {% if user.avatar_color == color %}selected{% endif %}"
                 style="background:{{ color }}"
                 data-color="{{ color }}"
                 data-target="avatar_color"
                 onclick="this.closest('.color-grid').querySelectorAll('.color-swatch').forEach(s=>s.classList.remove('selected'));this.classList.add('selected');document.querySelector('[name=avatar_color]').value='{{ color }}'">
            </div>
          {% endfor %}
        </div>
        <input type="hidden" name="avatar_color" value="{{ user.avatar_color }}">
      </div>

      {# Accent color #}
      <div class="settings-section">
        <div class="settings-label">–ê–∫—Ü–µ–Ω—Ç–Ω–∏–π –∫–æ–ª—ñ—Ä —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É</div>
        <div class="color-grid" id="accent-grid">
          {% set accent_colors = [
            ('#6366f1','–Ü–Ω–¥–∏–≥–æ'), ('#a855f7','–§—ñ–æ–ª–µ—Ç'), ('#ec4899','–†–æ–∂–µ–≤–∏–π'),
            ('#f43f5e','–ß–µ—Ä–≤–æ–Ω–∏–π'), ('#f97316','–ü–æ–º–∞—Ä–∞–Ω—á'), ('#eab308','–ñ–æ–≤—Ç–∏–π'),
            ('#10b981','–ó–µ–ª–µ–Ω–∏–π'), ('#06b6d4','–ë–ª–∞–∫–∏—Ç–Ω–∏–π'), ('#3b82f6','–°–∏–Ω—ñ–π')
          ] %}
          {% for color, label in accent_colors %}
            <div class="color-swatch {% if user.accent_color == color %}selected{% endif %}"
                 style="background:{{ color }}"
                 data-color="{{ color }}"
                 data-target="accent_color"
                 data-type="accent"
                 title="{{ label }}"
                 onclick="document.getElementById('accent-grid').querySelectorAll('.color-swatch').forEach(s=>s.classList.remove('selected'));this.classList.add('selected');document.querySelector('[name=accent_color]').value='{{ color }}';setAccentColor('{{ color }}')">
            </div>
          {% endfor %}
        </div>
        <input type="hidden" name="accent_color" value="{{ user.accent_color }}">
      </div>

      {# Theme #}
      <div class="settings-section">
        <div class="settings-label">–¢–µ–º–∞</div>
        <div class="theme-toggle-row">
          <div class="theme-label">–¢–µ–º–Ω–∞ —Ç–µ–º–∞</div>
          <button type="button" class="toggle-switch {% if user.theme == 'dark' %}on{% endif %}"
                  id="theme-toggle"
                  onclick="const next=toggleTheme();document.querySelector('[name=theme]').value=next;"></button>
        </div>
        <input type="hidden" name="theme" value="{{ user.theme or 'light' }}">
      </div>

      <div class="settings-section">
        <button type="submit" style="
          width:100%; padding:12px;
          background:var(--accent-grad); border:none; border-radius:10px;
          color:white; font-weight:700; font-size:0.95rem; cursor:pointer;
          box-shadow:0 4px 12px rgba(99,102,241,0.3);
        ">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
        <a href="/profile/{{ user.username }}" style="
          display:block; text-align:center; margin-top:10px;
          color:var(--text-2); font-size:0.875rem;">–°–∫–∞—Å—É–≤–∞—Ç–∏</a>
      </div>

      <div class="settings-section" style="border:none;">
        <a href="/logout" style="color:#ef4444;font-size:0.875rem;font-weight:600;">–í–∏–π—Ç–∏ –∑ –∞–∫–∞—É–Ω—Ç—É</a>
      </div>

    </form>

  </main>

  <aside class="sidebar-right"></aside>
</div>

<nav class="bottom-nav">
  <a href="/" class="bottom-nav-item"><span class="bnav-icon">üè†</span><span>–°—Ç—Ä—ñ—á–∫–∞</span></a>
  <a href="/search" class="bottom-nav-item"><span class="bnav-icon">üîç</span><span>–ü–æ—à—É–∫</span></a>
  <div class="bottom-nav-post"><button class="bottom-nav-post-btn" onclick="openModal('modal-post')">Ôºã</button></div>
  <a href="/notifications" class="bottom-nav-item"><span class="bnav-icon">üîî</span><span>–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è</span></a>
  <a href="/profile/{{ session.username }}" class="bottom-nav-item active"><span class="bnav-icon">üë§</span><span>–ü—Ä–æ—Ñ—ñ–ª—å</span></a>
</nav>
{% endblock %}